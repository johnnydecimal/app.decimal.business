---
import Layout from "@layouts/SiteLayout.astro";
import generateIdsWithACContext from "@helpers/generateIdsWithACContext.ts";
import wikiLinkify from "@helpers/wikiLinkify";
import sb from "@content/data/smallbusiness.ts";
import sbFlat from "@content/data/smallBusinessFlat.ts";
import type {
  EntryType,
  AreaEntry,
  CategoryEntry,
  IdEntry,
  FlattenedEntry,
} from "@content/data/smallBusinessFlat.ts";
import { findById } from "@content/data/smallBusinessFlat.ts";
import ID from "@components/ID.astro";

import Category from "@components/Category.astro";

const { slug } = Astro.params;

/**
 * This page handles the display of all areas, categories, and IDs. So first
 * we need to figure out which of those things we want. Then we fetch it,
 * then we display it. This is all done with components.
 *
 * If it doesn't exist, show our 04.04.
 *
 * We also need to handle the default case where the user visits /jdex.
 */

let entryType: EntryType | "default" | null = null;
let thisEntry: FlattenedEntry;
let renderObject: any;

if (slug?.match(/^[0-9]0-[0-9]9$/)) {
  entryType = "area";
} else if (slug?.match(/^\d\d$/)) {
  entryType = "category";
} else if (slug?.match(/^\d\d\.\d\d$/)) {
  entryType = "id";
} else {
  entryType = "default";
  // None of the above
}
---

{entryType === "area" ? <div>area</div> : null}
{entryType === "category" ? <Category category={slug!} /> : null}
{entryType === "id" ? <div>id</div> : null}

<!--
<Layout title={`${id} ${idTitle}`}>
  <h1 id="jd-id">{id} {idTitle}</h1>
  <button id="copy-jd-id">Copy</button>

  <div class="id-title">
    <a href={`/${areaId}`}>{areaId} {areaTitle}</a> &gt; <a
      href={`/${categoryId}`}
    >
      {categoryId} {categoryTitle}</a
    >
  </div>

  {
    idDescription && (
      <>
        <h3>Description</h3>
        <div set:html={idDescription} />
      </>
    )
  }
  {
    examples && (
      <>
        <h3>Examples</h3>
        <div set:html={examples} />
      </>
    )
  }
  {
    moreInfo && (
      <>
        <h3>More info</h3>
        <div set:html={moreInfo} />
      </>
    )
  }
  {
    exceptions && (
      <>
        <h3>Exceptions</h3>
        <div set:html={exceptions} />
      </>
    )
  }
  {
    alsoSee && (
      <>
        <h3>Also see</h3>
        <div set:html={alsoSee} />
      </>
    )
  }
  {
    rationale && (
      <>
        <h3>Rationale</h3>
        <div set:html={rationale} />
      </>
    )
  }
</Layout>
-->

<style></style>

<script>
  // document.getElementById("copy-jd-id")!.addEventListener("click", function () {
  //   const textToCopy = document.getElementById("jd-id")!.innerText;
  //   navigator.clipboard
  //     .writeText(textToCopy)
  //     .then(() => {
  //       alert("Text copied to clipboard!");
  //     })
  //     .catch((err) => {
  //       console.error("Failed to copy text: ", err);
  //     });
  // });
</script>
